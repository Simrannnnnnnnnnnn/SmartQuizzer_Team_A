{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-5">
        <div>
            <h1 class="fw-bold">Your Learning Library ðŸ“š</h1>
            <p class="text-muted">Review all questions generated from your study sessions.</p>
        </div>
        <a href="{{ url_for('routes.dashboard') }}" class="sunshine-btn px-4 py-2 shadow-sm">Generate More</a>
    </div>

    {% if not questions %}
    <div class="text-center py-5 glass-card">
        <div style="font-size: 4rem;">ðŸ“‚</div>
        <h4 class="mt-3 text-muted">Your library is empty.</h4>
        <p>Start by uploading a PDF or entering a topic in the dashboard!</p>
    </div>
    {% else %}
    <div class="row">
        {% for q in questions %}
        <div class="col-12 mb-4">
            <div class="card border-0 shadow-sm" style="border-radius: 20px; border-left: 6px solid #FFB300 !important;">
                <div class="card-body p-4">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                        <span class="badge bg-light text-dark border">Question #{{ q.id }}</span>
                        <span class="badge rounded-pill bg-warning text-dark">{{ q.difficulty_level or 'Standard' }}</span>
                    </div>
                    
                    <h5 class="fw-bold mb-4">{{ q.question_text }}</h5>

                    <div class="row g-2 mb-4">
                        {% set options = q.options_json|from_json %}
                        {% for key, val in options.items() %}
                        <div class="col-md-6">
                            <div class="p-2 border rounded-3 {% if key == q.correct_answer %}bg-success bg-opacity-10 border-success{% endif %}">
                                <strong>{{ key }}:</strong> {{ val }}
                                {% if key == q.correct_answer %} âœ…{% endif %}
                            </div>
                        </div>
                        {% endfor %}
                    </div>

                    <button class="btn btn-link text-decoration-none p-0 text-warning fw-bold" 
                            type="button" data-bs-toggle="collapse" data-bs-target="#explanation{{ q.id }}">
                        Show AI Explanation ðŸ’¡
                    </button>
                    
                    <div class="collapse mt-3" id="explanation{{ q.id }}">
                        <div class="p-3 bg-light rounded-4 border-start border-warning border-3">
                            <p class="mb-0 small text-dark"><strong>Reasoning:</strong> {{ q.explanation }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}
</div>

<style>
    .card { transition: transform 0.2s; }
    .card:hover { transform: scale(1.01); }
</style>
{% endblock %}